<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Site with JSON</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    button { margin: 5px 0; padding: 10px; }
    pre { background: #f4f4f4; padding: 10px; }
  </style>
</head>
<body>
  <h1>JSON Test Site</h1>

  <!-- 1. Загрузка JSON на диск -->
  <button id="saveJsonBtn">Сохранить JSON на диск</button>

  <!-- 2. Загрузка JSON с диска -->
  <input type="file" id="loadJsonInput" accept=".json">
  <pre id="loadedJson"></pre>

  <!-- 3. Fetch JSON с сайта -->
  <button id="fetchJsonBtn">Fetch JSON с сайта</button>
  <pre id="fetchedJson"></pre>

  <script>
    // Пример данных для сохранения
    const exampleData = { message: "Hello Netlify!", timestamp: Date.now() };

    // 1. Сохранение JSON на диск
    document.getElementById('saveJsonBtn').onclick = () => {
      const blob = new Blob([JSON.stringify(exampleData, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'example.json';
      a.click();
      URL.revokeObjectURL(url);
    };

    // 2. Загрузка JSON с диска
    document.getElementById('loadJsonInput').onchange = e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = ev => {
        try {
          const data = JSON.parse(ev.target.result);
          document.getElementById('loadedJson').textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          document.getElementById('loadedJson').textContent = 'Ошибка парсинга JSON';
        }
      };
      reader.readAsText(file);
    };

    // 3. Fetch JSON с сайта (Netlify)
    document.getElementById('fetchJsonBtn').onclick = () => {
      fetch('/example.json')
        .then(r => {
          if (!r.ok) throw new Error('Не удалось загрузить JSON');
          return r.json();
        })
        .then(data => {
          document.getElementById('fetchedJson').textContent = JSON.stringify(data, null, 2);
        })
        .catch(err => {
          document.getElementById('fetchedJson').textContent = 'Ошибка: ' + err.message;
        });
    };
  </script>
</body>
</html>
